


<!doctype html>
<html class="no-js" lang="en">
  
<head><!-- begin head.html -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
    DataStax Graph Queries | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />

    <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://docs.scylladb.com/">

    <link rel="author" href="mailto:info@scylladb.com">
    <link rel="stylesheet" href="../_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script src="../_static/js/vendor/modernizr.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8P2JP');</script>
    <!-- End Google Tag Manager -->

    <!-- Marketo -->
    <script type="text/javascript"> (function() { var didInit = false; function initMunchkin() { if(didInit === false) { didInit = true; Munchkin.init('791-QBF-350'); } } var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//munchkin.marketo.net/munchkin.js'; s.onreadystatechange = function() { if (this.readyState == 'complete' || this.readyState == 'loaded') { initMunchkin(); } }; s.onload = initMunchkin; document.getElementsByTagName('head')[0].appendChild(s); })(); </script>
    <!-- End Marketo -->

<!-- end head.html -->
</head>

<body>
<header id="header" class="animated">
    <div class="topbar_continer contain-to-grid clearfix">
        <nav class="top-bar" id="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <div class="logo">
                        <a href="/"><img src="../_static/img/logo-scylla-docs.svg" alt="" width="151"></a>
                    </div>
                </li>
                <li class="toggle-topbar"><a href="#"><span class="icon-manu"></span></a></li>
            </ul>
            <section class="top-bar-section clearfix">
                <ul class="right">
                    
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">Scylla Cloud</a>
                    </li>
                    
                    <li>
                        <a href="https://university.scylladb.com/">Scylla University</a>
                    </li>
                    
                    <li>
                        <a href="https://www.scylladb.com/">ScyllaDB Home</a>
                    </li>
                    
                    <li class="search_continer show-for-medium-up">	
                        <ci-search></ci-search>	
                    </li>	
                </ul>
            </section>
        </nav>
    </div>
</header>
<section id="content">
    <div class="row">

        <div class="large-6 large-push-3 columns">
            <div class="section" id="datastax-graph-queries">
<h1>DataStax Graph Queries<a class="headerlink" href="#datastax-graph-queries" title="Permalink to this headline">¶</a></h1>
<p>The Cassandra driver executes graph queries over the Cassandra native protocol. Use
<a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.execute_graph" title="cassandra.cluster.Session.execute_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.execute_graph()</span></code></a> or <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.execute_graph_async" title="cassandra.cluster.Session.execute_graph_async"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.execute_graph_async()</span></code></a> for
executing gremlin queries in DSE Graph.</p>
<p>Three Execution Profiles are provided suitable for graph execution:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.EXEC_PROFILE_GRAPH_DEFAULT" title="cassandra.cluster.EXEC_PROFILE_GRAPH_DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">EXEC_PROFILE_GRAPH_DEFAULT</span></code></a></li>
<li><a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT" title="cassandra.cluster.EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT</span></code></a></li>
<li><a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.EXEC_PROFILE_GRAPH_ANALYTICS_DEFAULT" title="cassandra.cluster.EXEC_PROFILE_GRAPH_ANALYTICS_DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">EXEC_PROFILE_GRAPH_ANALYTICS_DEFAULT</span></code></a></li>
</ul>
<p>See <a class="reference internal" href="../getting_started/"><span class="doc">Getting Started</span></a> and <a class="reference internal" href="../execution_profiles/"><span class="doc">Execution Profiles</span></a>
for more detail on working with profiles.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>First, we need to create a graph in the system. To access the system API, we
use the system execution profile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span><span class="p">,</span> <span class="n">EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="n">graph_name</span> <span class="o">=</span> <span class="s1">&#39;movies&#39;</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;system.graph(name).ifNotExists().create()&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">graph_name</span><span class="p">},</span>
                      <span class="n">execution_profile</span><span class="o">=</span><span class="n">EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT</span><span class="p">)</span>
</pre></div>
</div>
<p>To execute requests on our newly created graph, we need to setup an execution
profile. Additionally, we also need to set the schema_mode to <cite>development</cite>
for the schema creation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span><span class="p">,</span> <span class="n">GraphExecutionProfile</span><span class="p">,</span> <span class="n">EXEC_PROFILE_GRAPH_DEFAULT</span>
<span class="kn">from</span> <span class="nn">cassandra.datastax.graph</span> <span class="kn">import</span> <span class="n">GraphOptions</span>

<span class="n">graph_name</span> <span class="o">=</span> <span class="s1">&#39;movies&#39;</span>
<span class="n">ep</span> <span class="o">=</span> <span class="n">GraphExecutionProfile</span><span class="p">(</span><span class="n">graph_options</span><span class="o">=</span><span class="n">GraphOptions</span><span class="p">(</span><span class="n">graph_name</span><span class="o">=</span><span class="n">graph_name</span><span class="p">))</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">(</span><span class="n">execution_profiles</span><span class="o">=</span><span class="p">{</span><span class="n">EXEC_PROFILE_GRAPH_DEFAULT</span><span class="p">:</span> <span class="n">ep</span><span class="p">})</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;schema.config().option(&#39;graph.schema_mode&#39;).set(&#39;development&#39;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We are ready to configure our graph schema. We will create a simple one for movies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># properties are used to define a vertex</span>
<span class="n">properties</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">schema.propertyKey(&quot;genreId&quot;).Text().create();</span>
<span class="s2">schema.propertyKey(&quot;personId&quot;).Text().create();</span>
<span class="s2">schema.propertyKey(&quot;movieId&quot;).Text().create();</span>
<span class="s2">schema.propertyKey(&quot;name&quot;).Text().create();</span>
<span class="s2">schema.propertyKey(&quot;title&quot;).Text().create();</span>
<span class="s2">schema.propertyKey(&quot;year&quot;).Int().create();</span>
<span class="s2">schema.propertyKey(&quot;country&quot;).Text().create();</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span>  <span class="c1"># we can execute multiple statements in a single request</span>

<span class="c1"># A Vertex represents a &quot;thing&quot; in the world.</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">schema.vertexLabel(&quot;genre&quot;).properties(&quot;genreId&quot;,&quot;name&quot;).create();</span>
<span class="s2">schema.vertexLabel(&quot;person&quot;).properties(&quot;personId&quot;,&quot;name&quot;).create();</span>
<span class="s2">schema.vertexLabel(&quot;movie&quot;).properties(&quot;movieId&quot;,&quot;title&quot;,&quot;year&quot;,&quot;country&quot;).create();</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>

<span class="c1"># An edge represents a relationship between two vertices</span>
<span class="n">edges</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">schema.edgeLabel(&quot;belongsTo&quot;).single().connection(&quot;movie&quot;,&quot;genre&quot;).create();</span>
<span class="s2">schema.edgeLabel(&quot;actor&quot;).connection(&quot;movie&quot;,&quot;person&quot;).create();</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

<span class="c1"># Indexes to execute graph requests efficiently</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">schema.vertexLabel(&quot;genre&quot;).index(&quot;genresById&quot;).materialized().by(&quot;genreId&quot;).add();</span>
<span class="s2">schema.vertexLabel(&quot;genre&quot;).index(&quot;genresByName&quot;).materialized().by(&quot;name&quot;).add();</span>
<span class="s2">schema.vertexLabel(&quot;person&quot;).index(&quot;personsById&quot;).materialized().by(&quot;personId&quot;).add();</span>
<span class="s2">schema.vertexLabel(&quot;person&quot;).index(&quot;personsByName&quot;).materialized().by(&quot;name&quot;).add();</span>
<span class="s2">schema.vertexLabel(&quot;movie&quot;).index(&quot;moviesById&quot;).materialized().by(&quot;movieId&quot;).add();</span>
<span class="s2">schema.vertexLabel(&quot;movie&quot;).index(&quot;moviesByTitle&quot;).materialized().by(&quot;title&quot;).add();</span>
<span class="s2">schema.vertexLabel(&quot;movie&quot;).index(&quot;moviesByYear&quot;).secondary().by(&quot;year&quot;).add();</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Next, we’ll add some data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">g.addV(&#39;genre&#39;).property(&#39;genreId&#39;, 1).property(&#39;name&#39;, &#39;Action&#39;).next();</span>
<span class="s2">g.addV(&#39;genre&#39;).property(&#39;genreId&#39;, 2).property(&#39;name&#39;, &#39;Drama&#39;).next();</span>
<span class="s2">g.addV(&#39;genre&#39;).property(&#39;genreId&#39;, 3).property(&#39;name&#39;, &#39;Comedy&#39;).next();</span>
<span class="s2">g.addV(&#39;genre&#39;).property(&#39;genreId&#39;, 4).property(&#39;name&#39;, &#39;Horror&#39;).next();</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">g.addV(&#39;person&#39;).property(&#39;personId&#39;, 1).property(&#39;name&#39;, &#39;Mark Wahlberg&#39;).next();</span>
<span class="s2">g.addV(&#39;person&#39;).property(&#39;personId&#39;, 2).property(&#39;name&#39;, &#39;Leonardo DiCaprio&#39;).next();</span>
<span class="s2">g.addV(&#39;person&#39;).property(&#39;personId&#39;, 3).property(&#39;name&#39;, &#39;Iggy Pop&#39;).next();</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">g.addV(&#39;movie&#39;).property(&#39;movieId&#39;, 1).property(&#39;title&#39;, &#39;The Happening&#39;).</span>
<span class="s2">    property(&#39;year&#39;, 2008).property(&#39;country&#39;, &#39;United States&#39;).next();</span>
<span class="s2">g.addV(&#39;movie&#39;).property(&#39;movieId&#39;, 2).property(&#39;title&#39;, &#39;The Italian Job&#39;).</span>
<span class="s2">    property(&#39;year&#39;, 2003).property(&#39;country&#39;, &#39;United States&#39;).next();</span>

<span class="s2">g.addV(&#39;movie&#39;).property(&#39;movieId&#39;, 3).property(&#39;title&#39;, &#39;Revolutionary Road&#39;).</span>
<span class="s2">    property(&#39;year&#39;, 2008).property(&#39;country&#39;, &#39;United States&#39;).next();</span>
<span class="s2">g.addV(&#39;movie&#39;).property(&#39;movieId&#39;, 4).property(&#39;title&#39;, &#39;The Man in the Iron Mask&#39;).</span>
<span class="s2">    property(&#39;year&#39;, 1998).property(&#39;country&#39;, &#39;United States&#39;).next();</span>

<span class="s2">g.addV(&#39;movie&#39;).property(&#39;movieId&#39;, 5).property(&#39;title&#39;, &#39;Dead Man&#39;).</span>
<span class="s2">    property(&#39;year&#39;, 1995).property(&#39;country&#39;, &#39;United States&#39;).next();</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that our genre, actor and movie vertices are added, we’ll create the relationships (edges) between them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">genre_horror = g.V().hasLabel(&#39;genre&#39;).has(&#39;name&#39;, &#39;Horror&#39;).next();</span>
<span class="s2">genre_drama = g.V().hasLabel(&#39;genre&#39;).has(&#39;name&#39;, &#39;Drama&#39;).next();</span>
<span class="s2">genre_action = g.V().hasLabel(&#39;genre&#39;).has(&#39;name&#39;, &#39;Action&#39;).next();</span>

<span class="s2">leo  = g.V().hasLabel(&#39;person&#39;).has(&#39;name&#39;, &#39;Leonardo DiCaprio&#39;).next();</span>
<span class="s2">mark = g.V().hasLabel(&#39;person&#39;).has(&#39;name&#39;, &#39;Mark Wahlberg&#39;).next();</span>
<span class="s2">iggy = g.V().hasLabel(&#39;person&#39;).has(&#39;name&#39;, &#39;Iggy Pop&#39;).next();</span>

<span class="s2">the_happening = g.V().hasLabel(&#39;movie&#39;).has(&#39;title&#39;, &#39;The Happening&#39;).next();</span>
<span class="s2">the_italian_job = g.V().hasLabel(&#39;movie&#39;).has(&#39;title&#39;, &#39;The Italian Job&#39;).next();</span>
<span class="s2">rev_road = g.V().hasLabel(&#39;movie&#39;).has(&#39;title&#39;, &#39;Revolutionary Road&#39;).next();</span>
<span class="s2">man_mask = g.V().hasLabel(&#39;movie&#39;).has(&#39;title&#39;, &#39;The Man in the Iron Mask&#39;).next();</span>
<span class="s2">dead_man = g.V().hasLabel(&#39;movie&#39;).has(&#39;title&#39;, &#39;Dead Man&#39;).next();</span>

<span class="s2">the_happening.addEdge(&#39;belongsTo&#39;, genre_horror);</span>
<span class="s2">the_italian_job.addEdge(&#39;belongsTo&#39;, genre_action);</span>
<span class="s2">rev_road.addEdge(&#39;belongsTo&#39;, genre_drama);</span>
<span class="s2">man_mask.addEdge(&#39;belongsTo&#39;, genre_drama);</span>
<span class="s2">man_mask.addEdge(&#39;belongsTo&#39;, genre_action);</span>
<span class="s2">dead_man.addEdge(&#39;belongsTo&#39;, genre_drama);</span>

<span class="s2">the_happening.addEdge(&#39;actor&#39;, mark);</span>
<span class="s2">the_italian_job.addEdge(&#39;actor&#39;, mark);</span>
<span class="s2">rev_road.addEdge(&#39;actor&#39;, leo);</span>
<span class="s2">man_mask.addEdge(&#39;actor&#39;, leo);</span>
<span class="s2">dead_man.addEdge(&#39;actor&#39;, iggy);</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We are all set. You can now query your graph. Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find all movies of the genre Drama</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  g.V().has(&#39;genre&#39;, &#39;name&#39;, &#39;Drama&#39;).in(&#39;belongsTo&#39;).valueMap();&quot;&quot;&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Find all movies of the same genre than the movie &#39;Dead Man&#39;</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  g.V().has(&#39;movie&#39;, &#39;title&#39;, &#39;Dead Man&#39;).out(&#39;belongsTo&#39;).in(&#39;belongsTo&#39;).valueMap();&quot;&quot;&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Find all movies of Mark Wahlberg</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  g.V().has(&#39;person&#39;, &#39;name&#39;, &#39;Mark Wahlberg&#39;).in(&#39;actor&#39;).valueMap();&quot;&quot;&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
<p>To see a more graph examples, see <a class="reference external" href="https://github.com/datastax/graph-examples/">DataStax Graph Examples</a>.</p>
</div>
<div class="section" id="graph-types">
<span id="id1"></span><h2>Graph Types<a class="headerlink" href="#graph-types" title="Permalink to this headline">¶</a></h2>
<p>Here are the supported graph types with their python representations:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">DSE Graph</th>
<th class="head">Python</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>boolean</td>
<td>bool</td>
</tr>
<tr class="row-odd"><td>bigint</td>
<td>long, int (PY3)</td>
</tr>
<tr class="row-even"><td>int</td>
<td>int</td>
</tr>
<tr class="row-odd"><td>smallint</td>
<td>int</td>
</tr>
<tr class="row-even"><td>varint</td>
<td>int</td>
</tr>
<tr class="row-odd"><td>float</td>
<td>float</td>
</tr>
<tr class="row-even"><td>double</td>
<td>double</td>
</tr>
<tr class="row-odd"><td>uuid</td>
<td>uuid.UUID</td>
</tr>
<tr class="row-even"><td>Decimal</td>
<td>Decimal</td>
</tr>
<tr class="row-odd"><td>inet</td>
<td>str</td>
</tr>
<tr class="row-even"><td>timestamp</td>
<td>datetime.datetime</td>
</tr>
<tr class="row-odd"><td>date</td>
<td>datetime.date</td>
</tr>
<tr class="row-even"><td>time</td>
<td>datetime.time</td>
</tr>
<tr class="row-odd"><td>duration</td>
<td>datetime.timedelta</td>
</tr>
<tr class="row-even"><td>point</td>
<td>Point</td>
</tr>
<tr class="row-odd"><td>linestring</td>
<td>LineString</td>
</tr>
<tr class="row-even"><td>polygon</td>
<td>Polygon</td>
</tr>
<tr class="row-odd"><td>blob</td>
<td>bytearray, buffer (PY2), memoryview (PY3), bytes (PY3)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="graph-row-factory">
<h2>Graph Row Factory<a class="headerlink" href="#graph-row-factory" title="Permalink to this headline">¶</a></h2>
<p>By default (with <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphExecutionProfile.row_factory</span></code> set to <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.graph_object_row_factory" title="cassandra.datastax.graph.graph_object_row_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">datastax.graph.graph_object_row_factory()</span></code></a>), known graph result
types are unpacked and returned as specialized types (<a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.Vertex" title="cassandra.datastax.graph.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a>, <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.Edge" title="cassandra.datastax.graph.Edge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edge</span></code></a>). If the result is not one of these
types, a <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.Result" title="cassandra.datastax.graph.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">datastax.graph.Result</span></code></a> is returned, containing the graph result parsed from JSON and removed from its outer dict.
The class has some accessor convenience methods for accessing top-level properties by name (<cite>type</cite>, <cite>properties</cite> above),
or lists by index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># dicts with `__getattr__` or `__getitem__`</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;[[key_str: &#39;value&#39;, key_int: 3]]&quot;</span><span class="p">,</span> <span class="n">execution_profile</span><span class="o">=</span><span class="n">EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Using system exec just because there is no graph defined</span>
<span class="n">result</span>  <span class="c1"># cassandra.datastax.graph.Result({u&#39;key_str&#39;: u&#39;value&#39;, u&#39;key_int&#39;: 3})</span>
<span class="n">result</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># {u&#39;key_int&#39;: 3, u&#39;key_str&#39;: u&#39;value&#39;} (dict)</span>
<span class="n">result</span><span class="o">.</span><span class="n">key_str</span>  <span class="c1"># u&#39;value&#39;</span>
<span class="n">result</span><span class="o">.</span><span class="n">key_int</span>  <span class="c1"># 3</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;key_str&#39;</span><span class="p">]</span>  <span class="c1"># u&#39;value&#39;</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;key_int&#39;</span><span class="p">]</span>  <span class="c1"># 3</span>

<span class="c1"># lists with `__getitem__`</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s1">&#39;[[0, 1, 2]]&#39;</span><span class="p">,</span> <span class="n">execution_profile</span><span class="o">=</span><span class="n">EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result</span>  <span class="c1"># cassandra.datastax.graph.Result([0, 1, 2])</span>
<span class="n">result</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># [0, 1, 2] (list)</span>
<span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 1 (list[1])</span>
</pre></div>
</div>
<p>You can use a different row factory by setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">cluster.ExecutionProfile.row_factory</span></code> or passing it to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">cluster.Session.execute_graph()</span></code>. For example, <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.single_object_row_factory" title="cassandra.datastax.graph.single_object_row_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">datastax.graph.single_object_row_factory()</span></code></a> returns the JSON result string,
unparsed. <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.graph_result_row_factory" title="cassandra.datastax.graph.graph_result_row_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">datastax.graph.graph_result_row_factory()</span></code></a> returns parsed, but unmodified results (such that all metadata is retained,
unlike <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.graph_object_row_factory" title="cassandra.datastax.graph.graph_object_row_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">datastax.graph.graph_object_row_factory()</span></code></a>, which sheds some as attributes and properties are unpacked). These results
also provide convenience methods for converting to known types (<a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.Result.as_vertex" title="cassandra.datastax.graph.Result.as_vertex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datastax.graph.Result.as_vertex()</span></code></a>, <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.Result.as_edge" title="cassandra.datastax.graph.Result.as_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datastax.graph.Result.as_edge()</span></code></a>,</p>
<blockquote>
<div><a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.Result.as_path" title="cassandra.datastax.graph.Result.as_path"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datastax.graph.Result.as_path()</span></code></a>).</div></blockquote>
<p>Vertex and Edge properties are never unpacked since their types are unknown. If you know your graph schema and want to
deserialize properties, use the <a class="reference internal" href="../api/cassandra/datastax/graph/#cassandra.datastax.graph.GraphSON1Deserializer" title="cassandra.datastax.graph.GraphSON1Deserializer"><code class="xref py py-class docutils literal notranslate"><span class="pre">datastax.graph.GraphSON1Deserializer</span></code></a>. It provides convenient methods to deserialize by types (e.g.
deserialize_date, deserialize_uuid, deserialize_polygon etc.) Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ...</span>
<span class="kn">from</span> <span class="nn">cassandra.datastax.graph</span> <span class="kn">import</span> <span class="n">GraphSON1Deserializer</span>

<span class="n">row</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;g.V().toList()&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;my_property_key&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># accessing the VertexProperty value</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">GraphSON1Deserializer</span><span class="o">.</span><span class="n">deserialize_timestamp</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">value</span>  <span class="c1"># 2017-06-26 08:27:05</span>
<span class="nb">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># &lt;type &#39;datetime.datetime&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="named-parameters">
<h2>Named Parameters<a class="headerlink" href="#named-parameters" title="Permalink to this headline">¶</a></h2>
<p>Named parameters are passed in a dict to <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.execute_graph" title="cassandra.cluster.Session.execute_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cluster.Session.execute_graph()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_set</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s1">&#39;[a, b]&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">execution_profile</span><span class="o">=</span><span class="n">EXEC_PROFILE_GRAPH_SYSTEM_DEFAULT</span><span class="p">)</span>
<span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result_set</span><span class="p">]</span>  <span class="c1"># [1, 2]</span>
</pre></div>
</div>
<p>All python types listed in <a class="reference internal" href="#id1">Graph Types</a> can be passed as named parameters and will be serialized
automatically to their graph representation:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  g.addV(&#39;person&#39;).</span>
<span class="s2">  property(&#39;name&#39;, text_value).</span>
<span class="s2">  property(&#39;age&#39;, integer_value).</span>
<span class="s2">  property(&#39;birthday&#39;, timestamp_value).</span>
<span class="s2">  property(&#39;house_yard&#39;, polygon_value).toList()</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="p">{</span>
  <span class="s1">&#39;text_value&#39;</span><span class="p">:</span> <span class="s1">&#39;Mike Smith&#39;</span><span class="p">,</span>
  <span class="s1">&#39;integer_value&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
  <span class="s1">&#39;timestamp_value&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1967</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
  <span class="s1">&#39;polygon_value&#39;</span><span class="p">:</span> <span class="n">Polygon</span><span class="p">(((</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>
<span class="p">})</span>
</pre></div>
</div>
<p>As with all Execution Profile parameters, graph options can be set in the cluster default (as shown in the first example)
or specified per execution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ep</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execution_profile_clone_update</span><span class="p">(</span><span class="n">EXEC_PROFILE_GRAPH_DEFAULT</span><span class="p">,</span>
                                            <span class="n">graph_options</span><span class="o">=</span><span class="n">GraphOptions</span><span class="p">(</span><span class="n">graph_name</span><span class="o">=</span><span class="s1">&#39;something-else&#39;</span><span class="p">))</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="n">execution_profile</span><span class="o">=</span><span class="n">ep</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-graphson2-protocol">
<h2>Using GraphSON2 Protocol<a class="headerlink" href="#using-graphson2-protocol" title="Permalink to this headline">¶</a></h2>
<p>The default graph protocol used is GraphSON1. However GraphSON1 may
cause problems of type conversion happening during the serialization
of the query to the DSE Graph server, or the deserialization of the
responses back from a string Gremlin query. GraphSON2 offers better
support for the complex data types handled by DSE Graph.</p>
<p>DSE &gt;=5.0.4 now offers the possibility to use the GraphSON2 protocol
for graph queries. Enabling GraphSON2 can be done by <cite>changing the
graph protocol of the execution profile</cite> and <cite>setting the graphson2 row factory</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span><span class="p">,</span> <span class="n">GraphExecutionProfile</span><span class="p">,</span> <span class="n">EXEC_PROFILE_GRAPH_DEFAULT</span>
<span class="kn">from</span> <span class="nn">cassandra.datastax.graph</span> <span class="kn">import</span> <span class="n">GraphOptions</span><span class="p">,</span> <span class="n">GraphProtocol</span><span class="p">,</span> <span class="n">graph_graphson2_row_factory</span>

<span class="c1"># Create a GraphSON2 execution profile</span>
<span class="n">ep</span> <span class="o">=</span> <span class="n">GraphExecutionProfile</span><span class="p">(</span><span class="n">graph_options</span><span class="o">=</span><span class="n">GraphOptions</span><span class="p">(</span><span class="n">graph_name</span><span class="o">=</span><span class="s1">&#39;types&#39;</span><span class="p">,</span>
                                                      <span class="n">graph_protocol</span><span class="o">=</span><span class="n">GraphProtocol</span><span class="o">.</span><span class="n">GRAPHSON_2_0</span><span class="p">),</span>
                           <span class="n">row_factory</span><span class="o">=</span><span class="n">graph_graphson2_row_factory</span><span class="p">)</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">(</span><span class="n">execution_profiles</span><span class="o">=</span><span class="p">{</span><span class="n">EXEC_PROFILE_GRAPH_DEFAULT</span><span class="p">:</span> <span class="n">ep</span><span class="p">})</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">execute_graph</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Using GraphSON2, all properties will be automatically deserialized to
its Python representation. Note that it may bring significant
behavioral change at runtime.</p>
<p>It is generally recommended to switch to GraphSON2 as it brings more
consistent support for complex data types in the Graph driver and will
be activated by default in the next major version (Python dse-driver
driver 3.0).</p>
</div>
</div>

        </div>

        <div id="sidebar" class="large-3 large-pull-9 columns"><div class="side-nav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../execution_profiles/">Execution Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/">Performance Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../query_paging/">Paging Large Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lwt/">Lightweight Transactions (Compare-and-set)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_defined_types/">User Defined Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object_mapper/">Object Mapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geo_types/">DSE Geometry Types</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DataStax Graph Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_fluent/">DataStax Graph Fluent API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dates_and_times/">Working with Dates and Times</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/">Frequently Asked Questions</a></li>
</ul>

</div>
        </div>

    </div>
</section>

<!-- newsleter modal -->

<div id="newsletter_signup" class="reveal-modal tiny radius dark_modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">×</a>
    <h2 id="modalTitle">Sign up for the Scylla newsletter</h2>
    <div id="mc_embed_signup">
        <form action="//cloudius-systems.us10.list-manage.com/subscribe/post?u=df8bb543c68230d5f7b4dcf78&amp;id=9a4589f144" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
            <div id="mc_embed_signup_scroll">

                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-EMAIL">Email</label></div>
                        <div class="small-9 columns"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-FNAME">First Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="FNAME" class="" id="mce-FNAME"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-LNAME">Last Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="LNAME" class="" id="mce-LNAME"></div>
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_df8bb543c68230d5f7b4dcf78_9a4589f144" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" class="button" value="Sign up" name="subscribe" id="mc-embedded-subscribe"></div>
            </div>
        </form>
    </div>
</div>

<!-- end newsleter modal -->



<!-- footer.html -->
<footer id="footer">
    <div class="footer-top">
        <a class="logo" href="https://www.scylladb.com"><img src="../_static/img/logo-scylla-horizontal-RGB.svg" alt=""></a>
        <div class="footer-links">
            <a class="link" href="https://docs.scylladb.com">Docs</a>
            <a class="link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
            <a class="link" href="https://www.scylladb.com/company/">About Us</a>
            <a class="link button" href="https://github.com/scylladb/python-driver/issues/new?title=Issue in page DataStax Graph Queries&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20http://docs.scylladb.com/graph%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix" target="_blank">
                Report an issue on this page</a>
        </div>
        <div class="footer-actions">
            <a class="link-icon" href="https://github.com/ScyllaDB" target="_blank">
                <span class="icon-github2"></span></a>
            <a class="link-icon" href="https://twitter.com/ScyllaDB" target="_blank">
                <span class="icon-twitter"></span></a>
            <a class="link-icon" href="https://www.linkedin.com/company/scylladb"  target="_blank">
                <span class="icon-linkedin2"></span></a>
            <a class="link-icon" href="https://www.facebook.com/scylladb/" target="_blank">
                <span class="icon-facebook"></span></a>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-info">
            <div class="footer-copyright">
                &#169; 2013-2017 DataStax
            </div>
        </div>
        <div class="footer-links">
        </div>
    </div>
</footer>
<!-- end footer.html -->

<!-- bodyscripts.html -->
<!-- at the end of the BODY --> 
<script src="../_static/js/vendor/jquery.js"></script>
<script src="../_static/expertrec.js"></script>
<script src="../_static/js/foundation/foundation.js"></script>
<script src="../_static/js/foundation/foundation.topbar.js"></script>
<script src="../_static/app.js"></script>
<script>
    $(document).foundation();
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- end bodyscripts.html -->
</body>
</html>